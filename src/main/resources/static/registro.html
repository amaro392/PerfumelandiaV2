<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro - Perfumelandia</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #e74c3c;
      --accent-color: #3498db;
      --light-bg: #f8f9fa;
      --text-dark: #2c3e50;
      --border-color: #dee2e6;
      --success-color: #27ae60;
      --error-color: #e74c3c;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--light-bg);
      color: var(--text-dark);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .registro-container {
      max-width: 450px;
      width: 100%;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      padding: 40px;
      border: 1px solid var(--border-color);
    }

    .brand-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .brand-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .brand-title i {
      color: var(--secondary-color);
      margin-right: 10px;
    }

    .page-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
    }

    .page-subtitle {
      color: #6c757d;
      font-size: 0.95rem;
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-dark);
      font-weight: 500;
      font-size: 0.9rem;
    }

    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--border-color);
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.3s ease;
      background: white;
    }

    .form-control:focus {
      border-color: var(--accent-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }

    .form-control.is-invalid {
      border-color: var(--error-color);
    }

    .form-control.is-valid {
      border-color: var(--success-color);
    }

    .input-group {
      position: relative;
    }

    .input-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #6c757d;
      pointer-events: none;
    }

    .password-toggle {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #6c757d;
      z-index: 10;
    }

    .password-toggle:hover {
      color: var(--accent-color);
    }

    .invalid-feedback {
      display: block;
      color: var(--error-color);
      font-size: 0.875rem;
      margin-top: 5px;
    }

    .password-requirements {
      background: #f8f9fa;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 15px;
      margin-top: 10px;
      font-size: 0.875rem;
      display: none;
    }

    .password-requirements.show {
      display: block;
    }

    .requirement {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      color: #6c757d;
    }

    .requirement:last-child {
      margin-bottom: 0;
    }

    .requirement i {
      margin-right: 10px;
      width: 16px;
      text-align: center;
    }

    .requirement.valid {
      color: var(--success-color);
    }

    .btn-primary {
      width: 100%;
      padding: 12px;
      background-color: var(--secondary-color);
      border: none;
      border-radius: 6px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background-color: #c0392b;
    }

    .btn-primary:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }

    .login-link {
      text-align: center;
      margin-top: 25px;
      color: #6c757d;
      font-size: 0.9rem;
    }

    .login-link a {
      color: var(--accent-color);
      text-decoration: none;
    }

    .login-link a:hover {
      text-decoration: underline;
    }

    .spinner-border-sm {
      width: 1rem;
      height: 1rem;
      border-width: 0.15em;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .registro-container {
        margin: 20px;
        padding: 30px 25px;
      }
    }

    .alert {
      padding: 12px 16px;
      border-radius: 6px;
      margin-bottom: 20px;
      border: 1px solid;
    }

    .alert-success {
      background-color: #d4edda;
      border-color: #c3e6cb;
      color: #155724;
    }

    .alert-danger {
      background-color: #f8d7da;
      border-color: #f5c6cb;
      color: #721c24;
    }
  </style>
</head>
<body>
  <div class="registro-container">
    <div class="brand-header">
      <div class="brand-title">
        <i class="fas fa-spray-can"></i>
        Perfumelandia
      </div>
      <h1 class="page-title">Crear cuenta</h1>
      <p class="page-subtitle">Complete el formulario para registrarse</p>
    </div>

    <div id="alert-container"></div>

    <form id="registroForm" novalidate>
      <div class="form-group">
        <label class="form-label" for="nombre">Nombre completo *</label>
        <div class="input-group">
          <input 
            id="nombre" 
            type="text" 
            class="form-control" 
            placeholder="Ingrese su nombre completo"
            required
            autocomplete="name"
          />
          <i class="input-icon fas fa-user"></i>
        </div>
        <div class="invalid-feedback" id="nombre-error"></div>
      </div>

      <div class="form-group">
        <label class="form-label" for="email">Correo electrónico *</label>
        <div class="input-group">
          <input 
            id="email" 
            type="email" 
            class="form-control" 
            placeholder="ejemplo@correo.com"
            required
            autocomplete="email"
          />
          <i class="input-icon fas fa-envelope"></i>
        </div>
        <div class="invalid-feedback" id="email-error"></div>
      </div>

      <div class="form-group">
        <label class="form-label" for="password">Contraseña *</label>
        <div class="input-group">
          <input 
            id="password" 
            type="password" 
            class="form-control" 
            placeholder="Ingrese su contraseña"
            required
            autocomplete="new-password"
          />
          <i class="password-toggle fas fa-eye" id="togglePassword"></i>
        </div>
        <div class="invalid-feedback" id="password-error"></div>
        
        <div class="password-requirements" id="passwordRequirements">
          <div class="requirement" id="req-length">
            <i class="fas fa-times"></i>
            <span>Mínimo 8 caracteres</span>
          </div>
          <div class="requirement" id="req-uppercase">
            <i class="fas fa-times"></i>
            <span>Al menos una letra mayúscula</span>
          </div>
          <div class="requirement" id="req-lowercase">
            <i class="fas fa-times"></i>
            <span>Al menos una letra minúscula</span>
          </div>
          <div class="requirement" id="req-number">
            <i class="fas fa-times"></i>
            <span>Al menos un número</span>
          </div>
        </div>
      </div>

      <button type="submit" class="btn btn-primary" id="submitBtn">
        <span id="submitText">Crear cuenta</span>
        <div class="spinner-border spinner-border-sm d-none" id="submitSpinner" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
      </button>
    </form>

    <div class="login-link">
      ¿Ya tiene una cuenta? <a href="login.html">Inicie sesión aquí</a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Elementos del DOM
    const form = document.getElementById('registroForm');
    const nombreInput = document.getElementById('nombre');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const togglePassword = document.getElementById('togglePassword');
    const passwordRequirements = document.getElementById('passwordRequirements');
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const submitSpinner = document.getElementById('submitSpinner');
    const alertContainer = document.getElementById('alert-container');

    // Mostrar/ocultar contraseña
    togglePassword.addEventListener('click', function() {
      const type = passwordInput.type === 'password' ? 'text' : 'password';
      passwordInput.type = type;
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });

    // Mostrar requisitos de contraseña
    passwordInput.addEventListener('focus', function() {
      passwordRequirements.classList.add('show');
    });

    // Validar contraseña en tiempo real
    passwordInput.addEventListener('input', function() {
      const password = this.value;
      validatePasswordRequirements(password);
    });

    function validatePasswordRequirements(password) {
      // Validar longitud
      const lengthReq = document.getElementById('req-length');
      updateRequirement(lengthReq, password.length >= 8);

      // Validar mayúscula
      const uppercaseReq = document.getElementById('req-uppercase');
      updateRequirement(uppercaseReq, /[A-Z]/.test(password));

      // Validar minúscula
      const lowercaseReq = document.getElementById('req-lowercase');
      updateRequirement(lowercaseReq, /[a-z]/.test(password));

      // Validar número
      const numberReq = document.getElementById('req-number');
      updateRequirement(numberReq, /[0-9]/.test(password));
    }

    function updateRequirement(element, isValid) {
      const icon = element.querySelector('i');
      if (isValid) {
        element.classList.add('valid');
        icon.className = 'fas fa-check';
      } else {
        element.classList.remove('valid');
        icon.className = 'fas fa-times';
      }
    }

    // Validaciones individuales
    function validateName(name) {
      if (name.length < 2) {
        return 'El nombre debe tener al menos 2 caracteres';
      }
      if (!/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/.test(name)) {
        return 'El nombre solo puede contener letras y espacios';
      }
      return null;
    }

    function validateEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        return 'Ingrese un correo electrónico válido';
      }
      return null;
    }

    function validatePassword(password) {
      if (password.length < 8) {
        return 'La contraseña debe tener al menos 8 caracteres';
      }
      if (!/[A-Z]/.test(password)) {
        return 'La contraseña debe contener al menos una mayúscula';
      }
      if (!/[a-z]/.test(password)) {
        return 'La contraseña debe contener al menos una minúscula';
      }
      if (!/[0-9]/.test(password)) {
        return 'La contraseña debe contener al menos un número';
      }
      return null;
    }

    // Validar campo individual
    function validateField(input, validator) {
      const value = input.value.trim();
      const errorElement = document.getElementById(input.id + '-error');
      const error = validator(value);
      
      if (error) {
        input.classList.add('is-invalid');
        input.classList.remove('is-valid');
        errorElement.textContent = error;
        return false;
      } else {
        input.classList.remove('is-invalid');
        input.classList.add('is-valid');
        errorElement.textContent = '';
        return true;
      }
    }

    // Validar en tiempo real
    nombreInput.addEventListener('blur', () => validateField(nombreInput, validateName));
    emailInput.addEventListener('blur', () => validateField(emailInput, validateEmail));
    passwordInput.addEventListener('blur', () => validateField(passwordInput, validatePassword));

    // Mostrar alerta
    function showAlert(message, type = 'danger') {
      const alert = document.createElement('div');
      alert.className = `alert alert-${type} alert-dismissible fade show`;
      alert.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      `;
      alertContainer.appendChild(alert);
      
      // Auto-dismiss después de 5 segundos
      setTimeout(() => {
        if (alert.parentNode) {
          alert.remove();
        }
      }, 5000);
    }

    // Envío del formulario
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Validar todos los campos
      const isNameValid = validateField(nombreInput, validateName);
      const isEmailValid = validateField(emailInput, validateEmail);
      const isPasswordValid = validateField(passwordInput, validatePassword);
      
      if (!isNameValid || !isEmailValid || !isPasswordValid) {
        showAlert('Por favor, corrija los errores en el formulario');
        return;
      }

      // Verificar si el email ya está registrado
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const emailExists = users.some(user => user.email === emailInput.value.trim());
      
      if (emailExists) {
        showAlert('Este correo electrónico ya está registrado');
        return;
      }

      // Mostrar loading
      submitBtn.disabled = true;
      submitText.classList.add('d-none');
      submitSpinner.classList.remove('d-none');

      // Simular registro
      setTimeout(() => {
        // Guardar usuario
        const newUser = {
          id: Date.now(),
          nombre: nombreInput.value.trim(),
          email: emailInput.value.trim(),
          password: passwordInput.value, // En producción, esto debería estar encriptado
          fechaRegistro: new Date().toISOString()
        };

        users.push(newUser);
        localStorage.setItem('users', JSON.stringify(users));
        
        // Mostrar éxito
        showAlert('¡Registro exitoso! Bienvenido a Perfulandia', 'success');
        
        // Limpiar formulario
        form.reset();
        passwordRequirements.classList.remove('show');
        
        // Remover clases de validación
        [nombreInput, emailInput, passwordInput].forEach(input => {
          input.classList.remove('is-valid', 'is-invalid');
        });
        
        // Ocultar loading
        submitBtn.disabled = false;
        submitText.classList.remove('d-none');
        submitSpinner.classList.add('d-none');
        
        // Opcional: redirigir después de 2 segundos
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 2000);
        
      }, 1500);
    });

    // Ocultar requisitos cuando se hace clic fuera
    document.addEventListener('click', function(e) {
      if (!passwordInput.contains(e.target) && !passwordRequirements.contains(e.target)) {
        passwordRequirements.classList.remove('show');
      }
    });
  </script>
</body>
</html>